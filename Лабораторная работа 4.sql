-- 1. Вывести список академиков, отсортированный по количеству символов в ФИО
SELECT 
    ФИО, 
    LEN(ФИО) AS Длина_ФИО
FROM 
    Академики
ORDER BY 
    Длина_ФИО;

-- 2. Вывести список академиков, убрать лишние пробелы в ФИО
SELECT 
    LTRIM(RTRIM(ФИО)) AS ФИО_без_лишних_пробелов
FROM 
    Академики;

-- 3. Найти позиции «ов» в ФИО каждого академика. Вывести ФИО и номер позиции
SELECT 
    ФИО,
    CASE 
        WHEN ФИО LIKE '%ов%' THEN CHARINDEX('ов', ФИО)
        ELSE 0 
    END AS Позиция_ов
FROM 
    Академики;

-- 4. Вывести ФИО и последние две буквы специализации для каждого академика
SELECT 
    ФИО, 
    Специализация,
    RIGHT(Специализация, 2) AS Последние_две_буквы
FROM 
    Академики;

-- 5. Вывести список академиков, ФИО в формате Фамилия и Инициалы
SELECT 
    CONCAT(
        LEFT(ФИО, CHARINDEX(' ', ФИО)), ' ',
        SUBSTRING(ФИО, CHARINDEX(' ', ФИО) + 1, 1), '.',
        SUBSTRING(ФИО, 
            CHARINDEX(' ', ФИО, CHARINDEX(' ', ФИО) + 1) + 1, 1), '.'
    ) AS Фамилия_и_инициалы
FROM 
    Академики;

-- 6. Вывести список специализаций в правильном и обратном виде. Убрать дубликаты
SELECT DISTINCT
    Специализация,
    REVERSE(Специализация) AS Обратная_специализация
FROM 
    Академики;

-- 7. Вывести свою фамилию в одной строке столько раз, сколько вам лет (пример для 25 лет)
SELECT REPLICATE('Иванов ', 25) AS Повторенная_фамилия;

-- 8. Вывести абсолютное значение функций sin²(π/2) - cos(2π/2) с точностью два знака
SELECT 
    ROUND(ABS(POWER(SIN(PI()/2), 2) - COS(2*PI()/2)), 2) AS Результат;

-- 9. Вывести количество дней до конца семестра (пример до 31.12.2023)
SELECT 
    DATEDIFF(day, GETDATE(), '2023-12-31') AS Дней_до_конца_семестра;

-- 10. Вывести количество месяцев от вашего рождения (пример для даты рождения '1990-05-15')
SELECT 
    DATEDIFF(month, '1990-05-15', GETDATE()) AS Месяцев_с_рождения;

-- 11. Вывести ФИО и високосность года рождения каждого академика
SELECT 
    ФИО,
    YEAR(Дата_рождения) AS Год_рождения,
    CASE 
        WHEN (YEAR(Дата_рождения) % 4 = 0 AND YEAR(Дата_рождения) % 100 != 0) 
             OR (YEAR(Дата_рождения) % 400 = 0) 
        THEN 'Високосный'
        ELSE 'Не високосный'
    END AS Високосность
FROM 
    Академики;

-- 12. Вывести список специализаций без повторений с указанием "длинный"/"короткий"
SELECT DISTINCT
    Специализация,
    CASE 
        WHEN LEN(Специализация) > 10 THEN 'длинный'
        ELSE 'короткий'
    END AS Тип_длины
FROM 
    Академики;