-- 1. Вывести максимальную площадь стран
SELECT MAX(Площадь) AS Макс_площадь FROM Страны;

-- 2. Вывести наименьшее население стран в Африке
SELECT MIN(Население) AS Мин_население 
FROM Страны 
WHERE Континент = 'Африка';

-- 3. Вывести суммарное население стран Северной и Южной Америки
SELECT SUM(Население) AS Суммарное_население 
FROM Страны 
WHERE Континент IN ('Северная Америка', 'Южная Америка');

-- 4. Вывести среднее население стран, кроме европейских (округлить до 2 знаков)
SELECT ROUND(AVG(CAST(Население AS FLOAT)), 2) AS Среднее_население 
FROM Страны 
WHERE Континент != 'Европа';

-- 5. Вывести количество стран, название которых начинается с буквы «С»
SELECT COUNT(*) AS Количество 
FROM Страны 
WHERE LEFT(Название, 1) = 'С';

-- 6. Вывести количество континентов, где есть страны
SELECT COUNT(DISTINCT Континент) AS Количество_Континентов 
FROM Страны;

-- 7. Вывести разницу населения между странами с наибольшим и наименьшим количеством граждан
SELECT MAX(Население) - MIN(Население) AS Разница 
FROM Страны;

-- 8. Вывести количество стран на каждом континенте (сортировка по убыванию)
SELECT 
    Континент,
    COUNT(Название) AS Количество_Стран
FROM Страны
GROUP BY Континент
ORDER BY Количество_Стран DESC;

-- 9. Вывести количество стран по первым буквам в названии (алфавитная сортировка)
SELECT 
    LEFT(Название, 1) AS Первая_буква,
    COUNT(Название) AS Количество_Стран
FROM Страны
GROUP BY LEFT(Название, 1)
ORDER BY Первая_буква;

-- 10. Вывести континенты с плотностью населения >100 чел/км²
SELECT 
    Континент,
    AVG(CAST(Население AS FLOAT) / Площадь) AS Сред_Плотность
FROM Страны
GROUP BY Континент
HAVING AVG(CAST(Население AS FLOAT) / Площадь) > 100;

-- 11. Прогноз населения через 25 лет с разным ростом по континентам
SELECT 
    Континент,
    CASE
        WHEN Континент IN ('Европа', 'Азия') THEN FLOOR(SUM(Население) * 1.2)
        WHEN Континент IN ('Северная Америка', 'Африка') THEN FLOOR(SUM(Население) * 1.5)
        ELSE FLOOR(SUM(Население) * 1.7)
    END AS Прогноз_населения
FROM Страны
GROUP BY Континент;

-- 12. Континенты, где разница населения между странами не более 1000 раз
SELECT Континент
FROM Страны
GROUP BY Континент
HAVING MAX(Население) <= 1000 * MIN(Население);

-- 13. Количество стран без указанной столицы
SELECT COUNT(*) AS Количество
FROM Страны
WHERE Столица IS NULL;

-- 14. Длина самых длинных и коротких названий стран и столиц
SELECT 
    MAX(LEN(Название)) AS Дл_Название,
    MAX(LEN(Столица)) AS Дл_Столица,
    MIN(LEN(Название)) AS Кр_Название,
    MIN(LEN(Столица)) AS Кр_Столица
FROM Страны;

-- 15. Континенты со средней плотностью >30 чел/км² для стран площадью >1 млн км² (сортировка по убыванию)
SELECT 
    Континент,
    AVG(CAST(Население AS FLOAT) / Площадь) AS Плотность
FROM Страны
WHERE Площадь > 1000000
GROUP BY Континент
HAVING AVG(CAST(Население AS FLOAT) / Площадь) > 30
ORDER BY Плотность DESC;