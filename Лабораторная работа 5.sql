-- 1. Вывести минимальную площадь стран
SELECT MIN(Площадь) AS Минимальная_площадь
FROM Страны;

-- 2. Вывести наибольшую по населению страну в Северной и Южной Америке
SELECT TOP 1 Название, Население
FROM Страны
WHERE Континент IN ('Северная Америка', 'Южная Америка')
ORDER BY Население DESC;

-- 3. Вывести среднее население стран (округлить до одного знака)
SELECT ROUND(AVG(CAST(Население AS FLOAT)), 1) AS Среднее_население
FROM Страны;

-- 4. Количество стран, оканчивающихся на «ан», но не на «стан»
SELECT COUNT(*) AS Количество_стран
FROM Страны
WHERE Название LIKE '%ан' AND Название NOT LIKE '%стан';

-- 5. Количество континентов со странами на букву «Р»
SELECT COUNT(DISTINCT Континент) AS Количество_континентов
FROM Страны
WHERE Название LIKE 'Р%';

-- 6. Во сколько раз самая большая страна больше самой маленькой по площади
SELECT 
    MAX(Площадь) / MIN(Площадь) AS Соотношение_площадей,
    CONCAT('В ', CAST(MAX(Площадь) / MIN(Площадь) AS INT), ' раз') AS Текст
FROM Страны;

-- 7. Количество стран с населением >100 млн. на континенте (сортировка по возрастанию)
SELECT 
    Континент, 
    COUNT(*) AS Количество_стран
FROM Страны
WHERE Население > 100000000
GROUP BY Континент
ORDER BY Количество_стран ASC;

-- 8. Количество стран по длине названия (сортировка по убыванию)
SELECT 
    LEN(Название) AS Длина_названия,
    COUNT(*) AS Количество_стран
FROM Страны
GROUP BY LEN(Название)
ORDER BY Количество_стран DESC;

-- 9. Прогноз населения через 20 лет (+10%)
SELECT 
    Континент,
    FLOOR(SUM(Население) * 1.1) AS Прогнозируемое_население
FROM Страны
GROUP BY Континент;

-- 10. Континенты, где разница площадей стран не более 10000 раз
SELECT Континент
FROM Страны
GROUP BY Континент
HAVING MAX(Площадь) <= 10000 * MIN(Площадь);

-- 11. Средняя длина названий африканских стран
SELECT AVG(CAST(LEN(Название) AS FLOAT)) AS Средняя_длина_названий
FROM Страны
WHERE Континент = 'Африка';

-- 12. Континенты с средней плотностью >30 чел/км² для стран с населением >1 млн.
SELECT 
    Континент,
    AVG(CAST(Население AS FLOAT) / Площадь) AS Средняя_плотность
FROM Страны
WHERE Население > 1000000
GROUP BY Континент
HAVING AVG(CAST(Население AS FLOAT) / Площадь) > 30;